{"version":3,"file":"index.js","sources":["../src/fs.ts","../src/utils.ts","../src/git.ts","../src/package-manager.ts","../src/index.ts"],"sourcesContent":["import { promises as fs } from \"node:fs\";\nimport { join } from \"node:path\";\n\nexport const removeEmptyDirectories = async (dir: string): Promise<void> => {\n  const entries = await fs.readdir(dir, { withFileTypes: true });\n  for (const entry of entries) {\n    const fullPath = join(dir, entry.name);\n    if (entry.isDirectory()) {\n      await removeEmptyDirectories(fullPath);\n    }\n  }\n  // After processing subdirs, check if current dir is empty\n  const remaining = await fs.readdir(dir);\n  if (remaining.length === 0) {\n    await fs.rmdir(dir);\n  }\n};\n","import { exec } from \"node:child_process\";\nimport { readdirSync } from \"node:fs\";\nimport { join } from \"node:path\";\nimport { globifyGitIgnore } from \"globify-gitignore\";\n\nexport const execPromise = (command: string): Promise<void> =>\n  new Promise((resolve, reject) => {\n    exec(command, error => {\n      if (error) {\n        reject(error);\n      } else {\n        resolve();\n      }\n    });\n  });\n\nexport const getIgnorePatterns = async (): Promise<string[]> => {\n  const directory = process.cwd();\n  const entries = await Promise.all(\n    readdirSync(\".\", {\n      encoding: \"utf8\",\n      recursive: false,\n    })\n      .filter((file: string) => /^\\..(\\w+)ignore$/.test(file))\n      .map(async (file: string) => {\n        const entries = await globifyGitIgnore(\n          join(directory, file),\n          directory,\n          true,\n        );\n\n        return entries.filter(e => e.included).map(e => e.glob);\n      }),\n  );\n\n  return entries.flat();\n};\n","import { execPromise } from \"./utils.js\";\n\nexport const gitClean = async (\n  exclude: string[] = [\".env.local\"],\n): Promise<void> => {\n  const excludeArgs = exclude.map(e => `-e ${e}`).join(\" \");\n  const command = `git clean -Xfd ${excludeArgs}`;\n  return execPromise(command);\n};\n","import { execPromise } from \"./utils.js\";\n\nexport const pnpmInstall = async (): Promise<void> => execPromise(\"pnpm i\");\n","import { removeEmptyDirectories } from \"./fs.js\";\nimport { gitClean } from \"./git.js\";\nimport { pnpmInstall } from \"./package-manager.js\";\nimport { getIgnorePatterns } from \"./utils.js\";\n\nexport const gitCleanCommand = async (): Promise<void> => {\n  await Promise.all([removeEmptyDirectories(\".\"), gitClean()]);\n  await pnpmInstall();\n};\n\nexport { default as prettierConfig } from \"./prettier-config.js\";\nexport { getIgnorePatterns };\n"],"names":["fs","join","exec","readdirSync","entries","globifyGitIgnore"],"mappings":";;;;;;;AAGO,MAAM,yBAAyB,OAAO,QAA+B;AAC1E,QAAM,UAAU,MAAMA,iBAAG,QAAQ,KAAK,EAAE,eAAe,MAAM;AAC7D,aAAW,SAAS,SAAS;AAC3B,UAAM,WAAWC,UAAAA,KAAK,KAAK,MAAM,IAAI;AACrC,QAAI,MAAM,eAAe;AACvB,YAAM,uBAAuB,QAAQ;AAAA,IACvC;AAAA,EACF;AAEA,QAAM,YAAY,MAAMD,iBAAG,QAAQ,GAAG;AACtC,MAAI,UAAU,WAAW,GAAG;AAC1B,UAAMA,QAAAA,SAAG,MAAM,GAAG;AAAA,EACpB;AACF;ACXO,MAAM,cAAc,CAAC,YAC1B,IAAI,QAAQ,CAAC,SAAS,WAAW;AAC/BE,0BAAK,SAAS,CAAA,UAAS;AACrB,QAAI,OAAO;AACT,aAAO,KAAK;AAAA,IACd,OAAO;AACL,cAAA;AAAA,IACF;AAAA,EACF,CAAC;AACH,CAAC;AAEI,MAAM,oBAAoB,YAA+B;AAC9D,QAAM,YAAY,QAAQ,IAAA;AAC1B,QAAM,UAAU,MAAM,QAAQ;AAAA,IAC5BC,QAAAA,YAAY,KAAK;AAAA,MACf,UAAU;AAAA,MACV,WAAW;AAAA,IAAA,CACZ,EACE,OAAO,CAAC,SAAiB,mBAAmB,KAAK,IAAI,CAAC,EACtD,IAAI,OAAO,SAAiB;AAC3B,YAAMC,WAAU,MAAMC,iBAAAA;AAAAA,QACpBJ,UAAAA,KAAK,WAAW,IAAI;AAAA,QACpB;AAAA,QACA;AAAA,MAAA;AAGF,aAAOG,SAAQ,OAAO,CAAA,MAAK,EAAE,QAAQ,EAAE,IAAI,CAAA,MAAK,EAAE,IAAI;AAAA,IACxD,CAAC;AAAA,EAAA;AAGL,SAAO,QAAQ,KAAA;AACjB;AClCO,MAAM,WAAW,OACtB,UAAoB,CAAC,YAAY,MACf;AAClB,QAAM,cAAc,QAAQ,IAAI,CAAA,MAAK,MAAM,CAAC,EAAE,EAAE,KAAK,GAAG;AACxD,QAAM,UAAU,kBAAkB,WAAW;AAC7C,SAAO,YAAY,OAAO;AAC5B;ACNO,MAAM,cAAc,YAA2B,YAAY,QAAQ;ACGnE,MAAM,kBAAkB,YAA2B;AACxD,QAAM,QAAQ,IAAI,CAAC,uBAAuB,GAAG,GAAG,SAAA,CAAU,CAAC;AAC3D,QAAM,YAAA;AACR;;;;"}